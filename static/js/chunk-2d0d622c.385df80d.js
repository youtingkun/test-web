(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d622c"],{"70eb":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"mb20"},[i("icon-button",{directives:[{name:"has",rawName:"v-has",value:e.$auth.ROLE_ADD,expression:"$auth.ROLE_ADD"}],attrs:{type:"add"},on:{click:e.handleAdd}},[e._v(e._s(e.$t("common_add")))])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,border:"","header-row-class-name":"table-header"}},[i("el-table-column",{attrs:{type:"index",label:e.$t("common_order"),width:"100"}}),i("el-table-column",{attrs:{label:e.$t("system_rolename"),prop:"name"}}),i("el-table-column",{attrs:{label:e.$t("common_create_time"),prop:"createTime"}}),i("el-table-column",{attrs:{label:e.$t("common_operate_time"),prop:"updateTime"}}),i("el-table-column",{attrs:{label:e.$t("common_operator"),prop:"operatorName"}}),i("el-table-column",{attrs:{label:e.$t("common_remark"),prop:"remark"}}),i("el-table-column",{attrs:{label:e.$t("common_operation"),align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-button",{directives:[{name:"has",rawName:"v-has",value:e.$auth.ROLE_EDIT,expression:"$auth.ROLE_EDIT"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handlePermission(a.id)}}},[e._v(e._s(e.$t("system_authsetting")))]),i("el-button",{directives:[{name:"has",rawName:"v-has",value:e.$auth.AUTHORITY_EDIT,expression:"$auth.AUTHORITY_EDIT"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleEdit(a)}}},[e._v(e._s(e.$t("common_edit")))])]}}])})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.page.pageNum,limit:e.page.pageSize},on:{"update:page":function(t){return e.$set(e.page,"pageNum",t)},"update:limit":function(t){return e.$set(e.page,"pageSize",t)},pagination:e.getList}}),i("el-dialog",{attrs:{visible:e.dialogVisible,width:"600px",title:e.$t("add"===e.dialogType?"common_create":"common_edit"),"close-on-click-modal":!1,"destroy-on-close":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"menuForm",attrs:{model:e.menuForm,rules:e.rules,"label-width":"auto","label-position":"left"}},[i("el-form-item",{attrs:{label:e.$t("system_rolename"),prop:"name"}},[i("el-input",{attrs:{maxlength:"20",disabled:"edit"==e.dialogType},model:{value:e.menuForm.name,callback:function(t){e.$set(e.menuForm,"name",t)},expression:"menuForm.name"}})],1),i("el-form-item",{attrs:{label:e.$t("common_remark"),prop:"remark"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},maxlength:"100","show-word-limit":""},model:{value:e.menuForm.remark,callback:function(t){e.$set(e.menuForm,"remark",t)},expression:"menuForm.remark"}})],1)],1),i("div",{staticStyle:{"text-align":"right"}},[i("el-button",{on:{click:function(t){return e.handleCancel("menuForm")}}},[e._v(e._s(e.$t("common_cancel")))]),i("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.confirmRole("menuForm")}}},[e._v(e._s(e.$t("common_confirm")))])],1)],1),i("el-dialog",{attrs:{visible:e.permissionVisible,width:"600px",title:e.$t("common_edit"),"close-on-click-modal":!1},on:{"update:visible":function(t){e.permissionVisible=t}}},[e.permissionVisible?i("el-tree",{ref:"tree",staticClass:"permission-tree",attrs:{data:e.treeList,"show-checkbox":"","node-key":"id",props:e.defaultProps,"default-expanded-keys":e.permission},on:{check:e.handleCheckChange},model:{value:e.permission,callback:function(t){e.permission=t},expression:"permission"}}):e._e(),i("div",{staticStyle:{"text-align":"right"}},[i("el-button",{on:{click:function(t){e.permissionVisible=!1}}},[e._v(e._s(e.$t("common_cancel")))]),i("el-button",{attrs:{type:"primary"},on:{click:e.confirmPermission}},[e._v(e._s(e.$t("common_confirm")))])],1)],1)],1)},n=[],s=(i("99af"),i("d81d"),i("b0c0"),i("5530")),o=i("8593"),r=i("ed08"),l={name:"merchantRole",data:function(){return{total:0,list:[],listLoading:!0,btnLoading:!1,permissionVisible:!1,permission:[],treeList:[],page:{pageNum:1,pageSize:10},defaultProps:{children:"children",label:"remark"},selectList:[],dialogVisible:!1,dialogType:"add",menuForm:{id:"",name:"",remark:""},rules:{name:[{required:!0,message:"required",trigger:"blur"}]},rolekey:[]}},created:function(){this.getList(),this.getMenuList()},methods:{getList:function(){var e=this;Object(o["o"])(Object(s["a"])({param:Object(s["a"])({},this.searchForm)},this.page)).then((function(t){e.list=t.data.list,e.total=t.data.total,e.listLoading=!1}))},handleAdd:function(){this.dialogType="add",this.menuForm={id:"",name:"",remark:""},this.dialogVisible=!0},handleEdit:function(e){this.dialogType="edit",this.menuForm={id:e.id,name:e.name,remark:e.remark},this.dialogVisible=!0},handleCancel:function(e){this.dialogVisible=!1,this.$refs[e].resetFields()},handlePermission:function(e){this.menuForm.id=e,this.getRoleEdit(e)},getMenuList:function(){var e=this;Object(o["d"])().then((function(t){e.treeList=Object(r["b"])(t.data)}))},getRoleEdit:function(e){var t=this;Object(o["j"])({id:e}).then((function(e){t.permission=[];var i=(e.data||[]).map((function(e){return e.id}));t.permission=i,t.permissionVisible=!0,t.$nextTick((function(){this.$refs.tree.setCheckedKeys(i)}))}))},handleCheckChange:function(e,t){this.permission=t.checkedKeys.concat(t.halfCheckedKeys)},confirmPermission:function(){var e=this,t=this.$refs.tree.getHalfCheckedKeys(),i=this.$refs.tree.getCheckedKeys(),a={roleId:this.menuForm.id,authorityIdList:i.concat(t)};Object(o["x"])(a).then((function(t){e.$message({message:t.message,type:"success"}),e.permissionVisible=!1,e.getList()}))},confirmRole:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var i="edit"==t.dialogType;t.btnLoading=!0,i?Object(o["n"])(Object(s["a"])({},t.menuForm)).then((function(e){t.$message({message:e.message,type:"success"}),t.getList(),t.dialogVisible=!1,t.btnLoading=!1})):Object(o["m"])(Object(s["a"])({},t.menuForm)).then((function(e){t.$message({message:e.message,type:"success"}),t.getList(),t.dialogVisible=!1,t.btnLoading=!1}))}))}}},m=l,c=i("2877"),d=Object(c["a"])(m,a,n,!1,null,null,null);t["default"]=d.exports}}]);