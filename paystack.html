<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="robots" content="noindex" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"
    />
    <!--320-->
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico" />
    <link href="css/pages-dependencies.css" rel="stylesheet" />
    <link href="css/pages.css" rel="stylesheet" />
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!--TRACKING-->
    <!--TRACKING END-->
    <title>Pay for GOCASH - Paystack</title>
    <meta name="generator" content="SEOmatic" />
    <meta
      name="keywords"
      content="pay online, online payment, payment gateway, payment processor, paystack, accept payment online"
    />
    <meta name="description" content="customer payment" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <meta name="robots" content="all" />
    <meta content="1963073953927815" property="fb:profile_id" />
    <meta content="en_US" property="og:locale" />
    <meta content="en_GH" property="og:locale:alternate" />
    <meta content="en_US" property="og:locale:alternate" />
    <meta content="Paystack" property="og:site_name" />
    <meta content="business.business" property="og:type" />
    <meta content="https://paystack.com/pay/sokoloan99" property="og:url" />
    <meta content="Pay for sokoloan - Paystack" property="og:title" />
    <meta content="customer payment" property="og:description" />
    <meta content="images/opengraph.png" property="og:image" />
    <meta content="1200" property="og:image:width" />
    <meta content="630" property="og:image:height" />
    <meta
      content="An image of the Paystack logo - four blue stripes, 3 long and 1 short - in the shape of a P, against a dark blue (almost black) background"
      property="og:image:alt"
    />
    <meta
      content="https://www.instagram.com/paystackhq/"
      property="og:see_also"
    />
    <meta content="https://www.youtube.com/paystackhq" property="og:see_also" />
    <meta
      content="https://www.linkedin.com/company/paystack/"
      property="og:see_also"
    />
    <meta
      content="https://www.facebook.com/PaystackHQ/"
      property="og:see_also"
    />
    <meta content="https://twitter.com/paystack" property="og:see_also" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@paystack" />
    <meta name="twitter:creator" content="@paystack" />
    <meta name="twitter:title" content="Pay for sokoloan - Paystack" />
    <meta name="twitter:description" content="customer payment" />
    <meta
      name="twitter:image"
      content="https://paystack.com/public/opengraph.png"
    />
    <meta name="twitter:image:width" content="1024" />
    <meta name="twitter:image:height" content="512" />
    <meta
      name="twitter:image:alt"
      content="An image of the Paystack logo - four blue stripes, 3 long and 1 short - in the shape of a P, against a dark blue (almost black) background"
    />
    <!-- <link href="https://paystack.com/pay/sokoloan99" rel="canonical"> -->
    <link href="https://paystack.com/" rel="home" />
    <link
      type="text/plain"
      href="https://paystack.com/humans.txt"
      rel="author"
    />
    <!-- <link href="https://paystack.com/gh/pay/sokoloan99" rel="alternate" hreflang="en-gh"> -->
    <!-- <link href="https://paystack.com/pay/sokoloan99" rel="alternate" hreflang="x-default"> -->
    <!-- <link href="https://paystack.com/pay/sokoloan99" rel="alternate" hreflang="en-us"> -->
  </head>

  <body class="paystack-container">
    <div class="paystack-color-bar"></div>
    <div id="page-okay" class="paystack-wrapper animated fadeIn">
      <div id="payment-page-pay" class="paystack-page">
        <div class="header">
          <div class="company-logo">
            <img id="company-logo-img" src="" alt="" />
          </div>
          <!-- <div class="page-info">
            <h3 id="page-name" class="page-name"></h3>
            <p class="company-name">BY <span id="company-name">SOKOLENDING</span></p>
          </div>
          <div class="page-description">
            <span id="page-description">customer payment</span>
          </div> -->
        </div>
        <div class="body">
          <form id="payment-form" name="payment-form" class="payment-form">
            <div class="error-message">
              <i class="fa fa-warning"></i>
              <span></span>
            </div>
            <div class="element-pair">
              <div class="element-pair-container">
                <div class="element-wrap">
                  <div class="element-label">
                    <span>First Name</span>
                  </div>
                  <input
                    id="customer-first-name"
                    type="text"
                    class="element-is-input"
                    data-validetta="required"
                    required=""
                    data-set="first_name"
                  />
                </div>
                <div class="element-wrap">
                  <div class="element-label">
                    <span>Last Name</span>
                  </div>
                  <input
                    id="customer-last-name"
                    type="text"
                    class="element-is-input"
                    data-set="last_name"
                  />
                </div>
              </div>
            </div>
            <div class="element-wrap">
              <div class="element-label">
                <span>Email Address</span>
              </div>
              <input
                id="customer-email"
                type="email"
                class="element-is-input"
                data-validetta="required,email"
                required=""
                data-set="email"
              />
            </div>
            <!-- <div id="phone-number" class="element-wrap"> 
       <div class="element-label">
        <span>Phone Number</span>
       </div> 
       <input id="customer-phone" type="tel" class="element-is-input" data-validetta="required,number" required="" /> 
      </div>  -->
            <div class="element-pair">
              <div class="element-label">
                <span>Amount to charge</span>
              </div>
              <div class="element-pair-container">
                <div
                  class="element-wrap element-wrap-for-select element-wrap-on-left"
                >
                  <select
                    id="payment-currency-options"
                    class="element-is-select"
                    disabled="true"
                    value="0"
                  >
                    <option>NGN</option>
                  </select>
                </div>
                <div class="element-wrap element-wrap-on-right">
                  <input
                    id="payment-amount"
                    type="text"
                    class="element-is-input"
                    data-validetta="required"
                    required=""
                    data-set="amount"
                  />
                </div>
              </div>
            </div>
            <div id="custom-fields">
              <div class="element-wrap">
                <div class="element-label">
                  <span>orderNumber</span>
                </div>
                <input
                  id="customer-ordernumber"
                  type="text"
                  class="element-is-input"
                  required=""
                  value=""
                  data-set="ordernumber"
                />
              </div>
              <div class="element-wrap">
                <div class="element-label">
                  <span>mobile</span>
                </div>
                <input
                  id="customer-mobile"
                  type="text"
                  class="element-is-input"
                  required=""
                  value=""
                  data-set="mobile"
                />
              </div>
            </div>
            <div id="custom-fields"></div>
            <div class="element-wrap element-wrap-for-submit">
              <button type="submit" id="pay-btn" class="button button-is-green">
                Pay Now
              </button>
            </div>
          </form>
          <div
            id="payment-success"
            class="payment-success animated fadeIn text-center hidden"
          >
            <img src="images/success.png" />
            <h3>Your payment was successful</h3>
            <h5 class="payment-success-message"></h5>
          </div>
        </div>
      </div>
      <div id="paystack-footer" class="paystack-footer animated fadeIn">
        <a target="_blank" href="https://paystack.com/what-is-paystack">
          <img
            alt="Paystack secured badge"
            src="images/paystack-badge-cards-ngn.png"
          />
        </a>
      </div>
      <style>
        .element-helper {
          font-size: 13px;
          color: #777;
          margin-top: 5px;
        }

        .summary {
          border-top: solid 1px #e6e6e6;
          margin-top: 20px;
          padding: 20px 0 0;
        }

        .summary p {
          font-size: 14px;
          font-weight: bold;
          margin: 0;
        }

        .button-is-wide {
          width: 100%;
        }
      </style>
    </div>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script src="js/jquery-1.4.2.min.js"></script>
    <script>
      var repayType = ''
      window.onload = function () {
        let params = decodeParams()
        fillForm(params)
        repayType = params.repayType == 1 ? 'el' : ''
        getData(params.ordernumber)
      }
      function decodeParams(url) {
        //解码url信息
        url = url == null ? window.location.href : url

        var search = url.substring(url.lastIndexOf('?') + 1)
        var obj = {}
        var reg = /([^?&=]+)=([^?&=]*)/g
        search.replace(reg, function (rs, $1, $2) {
          var name = decodeURIComponent($1)
          var val = decodeURIComponent($2)
          val = String(val)
          obj[name] = val
          return rs
        })
        return obj
      }

      function fillForm(data) {
        let arr = data.readonly.split(',')
        let domarr = document.querySelectorAll('input')
        domarr.forEach((item) => {
          let dataKey = item.dataset.set
          if (dataKey in data) {
            item.value = data[dataKey]
          }
          for (var i = 0; i < arr.length; i++) {
            if (dataKey === arr[i]) {
              item.setAttribute('disabled', 'disabled')
            }
          }
        })
        if (data.repayType == 1) {
          document
            .getElementById('payment-amount')
            .setAttribute('disabled', 'disabled')
        }
      }
      var ref = ''
      var key = ''
      function getData(id) {
        $.ajax({
          type: 'POST',
          url: 'http://api.kpflying.com/api/pay/paystack',
          contentType: 'application/json;charset=utf-8',
          dataType: 'json',
          data: JSON.stringify({
            param: {
              orderNumber: id,
            },
          }),
          success: function (result) {
            ref = result.data.ref
            key = result.data.pk
            $('#company-logo-img').attr('src', result.data.logo)
          },
          //请求失败，包含具体的错误信息
          error: function (e) {
            console.log(e.status)
            console.log(e.responseText)
          },
        })
      }
      const paymentForm = document.getElementById('payment-form')
      paymentForm.addEventListener('submit', payWithPaystack, false)
      function payWithPaystack(e) {
        console.log('repayType', repayType)
        console.log('ref', ref)
        e.preventDefault()
        window.localStorage.setItem(
          'amount',
          document.getElementById('payment-amount').value
        )
        //alert(1);
        let handler = PaystackPop.setup({
          key: key, // Replace with your public key   pk_live_3223432j3328nmdsad233tIshFeQd4XMUh
          email: document.getElementById('customer-email').value,
          amount: document.getElementById('payment-amount').value * 100,
          firstname: document.getElementById('customer-first-name').value,
          lastname: document.getElementById('customer-last-name').value,
          metadata: {
            custom_fields: [
              {
                display_name: 'orderNumber',
                variable_name: 'ordernumber',
                value: document.getElementById('customer-ordernumber').value,
              },
              {
                display_name: 'mobile',
                variable_name: 'mobile',
                value: document.getElementById('customer-mobile').value,
              },
            ],
          },
          ref: ref + Math.floor(Math.random() * 1000000000 + 1) + repayType, // generates a pseudo-unique reference. Please replace with a reference you generated. Or remove the line entirely so our API will generate one for you
          // label: "Optional string that replaces customer email"
          onClose: function () {
            alert('Window closed.')
          },
          callback: function (response) {
            window.location.href =
              'success.html?amount=' + window.localStorage.getItem('amount')
            // javascript: window.history.forward(1);
            // history.pushState(null, null, document.URL);
            // window.addEventListener('popstate', function () {
            //   history.pushState(null, null, document.URL);
            // });
          },
        })
        handler.openIframe()
      }
    </script>
  </body>
</html>
